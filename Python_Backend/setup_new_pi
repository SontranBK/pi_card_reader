"""""""""""""""""
1) before you start lauching following commands, do this 
when you flash Raspberry Pi Ubuntu SD Card:
"""""""""""""""""
sudo nano /boot/firmware/config.txt
Identify the following line:

dtoverlay=vc4-kms-v3d
and change it to:

dtoverlay=vc4-fkms-v3d


"""""""""""""""""
2) Initialize operating system and source code
"""""""""""""""""
install setting for Ubuntu system, set user name to "Meta_edu"
download this source code from github and put it in "home" folder
change the name of main folder to "pi_card_reader"


"""""""""""""""""
3) Now run those command to install dependencies:
"""""""""""""""""
cd ~
sudo apt install --assume-yes chromium-browser
cd ~
sudo apt install python3-pip
cd ~
sudo pip install pyserial
cd ~
sudo python3 -m pip install firebase-admin
cd ~
sudo apt install linux-modules-extra-raspi
cd ~
sudo apt-get install minicom
sudo minicom -s

""""""""""""""""""
""""""""""""""""""
Run minicom with sudo minicom -s, go to "Serial port setup" 
Change the first line to /dev/ttyUSB0.
Save config as default with "Save setup as dfl". 
Restart your Pi
""""""""""""""""""
""""""""""""""""""

### use lsusb to check vendor and product id
sudo modprobe usbserial vendor=1a86 product=7532
### For some reason, some reader need to add 0x in font of id, eg:
sudo modprobe usbserial vendor=0x31aa product=0x3000
### Then use following line to check if ports are open:
sudo python3 -m serial.tools.list_ports

cd ~
sudo snap install flutter --classic
sudo flutter doctor -v
cd ~
cd pi_card_reader/
sudo flutter config --enable-web
sudo flutter create --platforms=web .
sudo flutter pub add firebase_messaging
sudo flutter pub upgrade firebase_messaging
sudo flutter pub upgrade

"""""""""""""""""
4) Make system auto-boot and auto-config 
"""""""""""""""""
click "show application" or "activities", type in "Startup Application" and open it, then click "Add", then set:
- Name: terminal
- Command: /user/bin/gnome-terminal.real

now right-click Terminal and open Preferences: 
- add Profiles named "Meta_edu" and click down arrow, then choose "Set as default"
- now navigate to "Command" tab in profile "Meta_edu", choose both "Run command as a login shell" and "Run custom command instead of my shell"
- add line "sh ./pi_card_reader/Bash_Script/auto_boot.sh" to Custom command
- if possible, in "Text" tab, set "Initial terminal size" to 100 columns and 100 rows

then, install "Autohide Downloads Bar" extension for chromium here (https://chrome.google.com/webstore/detail/autohide-downloads-bar/iaefpjibipfaofmigecedfapfgplmplo)
and set "Delay Timer" of this extension to 0.

then, go to Chromium setting (chrome://settings/content/notifications), in "Allowed to send notifications" part, add link: http://localhost:41200
